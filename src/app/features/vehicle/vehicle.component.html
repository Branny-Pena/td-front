<app-wizard-layout
  [currentStep]="2"
  [nextDisabled]="form.invalid || isLoading()"
  [isLoading]="isLoading()"
  (backClick)="onBack()"
  (nextClick)="onNext()">

  <app-content-card title="Información del Vehículo">
    <button
      cardActions
      class="td-btn td-btn--standard !px-2 !py-2"
      type="button"
      (click)="scanQr()"
      aria-label="Escanear QR/Auto para autocompletar formulario">
      <svg viewBox="0 0 24 24" class="h-4 w-4" aria-hidden="true" fill="none" stroke="currentColor" stroke-width="1.5">
        <path stroke-linecap="round" stroke-linejoin="round" d="M4 4h6v6H4V4Zm10 0h6v6h-6V4ZM4 14h6v6H4v-6Zm10 6v-6h2v2h2v-2h2v6h-6Z" />
        <path stroke-linecap="round" stroke-linejoin="round" d="M14 10h1m-1 2h3m-3 2h1m2-4h3" />
      </svg>
    </button>

    <form [formGroup]="form" class="flex flex-col gap-4">

      <app-barcode-scanner-dialog
        [isOpen]="isScannerOpen()"
        title="Escanear QR/Auto"
        [formats]="vehicleScannerFormats"
        (scanned)="onVehicleCodeScanned($event)"
        (closed)="closeScanner()"
      />

      @if (errorMessage()) {
        <div class="p-3 bg-red-50 border border-red-200 rounded text-red-700 text-sm" role="alert">
          {{ errorMessage() }}
        </div>
      }

      <div class="mb-4">
        <input
          type="text"
          id="make"
          formControlName="make"
          placeholder="Marca *"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 td-ring-primary disabled:bg-gray-100 disabled:text-gray-700 disabled:cursor-not-allowed"
          aria-label="Marca"
          aria-required="true" />
      </div>

      <div class="mb-4">
        <input
          type="text"
          id="model"
          formControlName="model"
          placeholder="Modelo *"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 td-ring-primary disabled:bg-gray-100 disabled:text-gray-700 disabled:cursor-not-allowed"
          aria-label="Modelo"
          aria-required="true" />
      </div>

      <div class="mb-4">
        <input
          type="text"
          id="color"
          formControlName="color"
          placeholder="Color *"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 td-ring-primary disabled:bg-gray-100 disabled:text-gray-700 disabled:cursor-not-allowed"
          aria-label="Color"
          aria-required="true" />
      </div>

      <div class="mb-4">
        <input
          type="text"
          id="licensePlate"
          formControlName="licensePlate"
          placeholder="Placa *"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 td-ring-primary"
          aria-label="Placa"
          aria-required="true" />
      </div>

      <div class="mb-4">
        <input
          type="text"
          id="vinNumber"
          formControlName="vinNumber"
          placeholder="Número VIN"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 td-ring-primary"
          aria-label="Número VIN" />
        @if (isLookupLoading()) {
          <span class="mt-1 inline-block text-xs td-text-primary">Buscando...</span>
        }
      </div>

      <div class="mb-4">
        <input
          type="text"
          id="location"
          formControlName="location"
          placeholder="Ubicación *"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 td-ring-primary"
          aria-label="Ubicación"
          aria-required="true" />
      </div>
    </form>
  </app-content-card>

</app-wizard-layout>

