<app-wizard-layout
  [currentStep]="2"
  [showStepper]="false"
  [showBottomNav]="false"
  [showBack]="false"
  [showNext]="false">
  <div class="max-w-3xl mx-auto">
    <app-content-card title="Informacion del vehiculo">
      <form [formGroup]="form" class="flex flex-col gap-4">
        <div class="mb-4">
          <input
            type="text"
            id="make"
            formControlName="make"
            placeholder="Marca *"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 td-ring-primary"
            aria-label="Marca"
            aria-required="true" />
        </div>

        <div class="mb-4">
          <input
            type="text"
            id="model"
            formControlName="model"
            placeholder="Modelo *"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 td-ring-primary"
            aria-label="Modelo"
            aria-required="true" />
        </div>

        <div class="mb-4">
          <input
            type="text"
            id="color"
            formControlName="color"
            placeholder="Color *"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 td-ring-primary"
            aria-label="Color"
            aria-required="true" />
        </div>

        <div class="mb-4">
          <input
            type="text"
            id="licensePlate"
            formControlName="licensePlate"
            placeholder="Placa *"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 td-ring-primary"
            aria-label="Placa"
            aria-required="true" />
        </div>

        <div class="mb-4">
          <input
            type="text"
            id="vinNumber"
            formControlName="vinNumber"
            placeholder="Numero VIN"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 td-ring-primary"
            aria-label="Numero VIN" />
        </div>

        <div class="mb-4">
          <input
            type="text"
            id="location"
            formControlName="location"
            placeholder="Ubicacion *"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 td-ring-primary"
            aria-label="Ubicacion"
            aria-required="true" />
        </div>

        <div class="flex items-center justify-between gap-3 pt-2">
          <button type="button" class="td-btn td-btn--standard" (click)="onBack()">
            Volver
          </button>
          <button
            type="button"
            class="td-btn td-btn--emphasized"
            (click)="generateQr()"
            [disabled]="isGenerating()">
            {{ isGenerating() ? 'Generando...' : 'Generar QR' }}
          </button>
        </div>
      </form>
    </app-content-card>
  </div>

  <app-modal-dialog
    [isOpen]="isDialogOpen()"
    title="QR generado"
    acceptText="Descargar"
    rejectText="Cerrar"
    (accept)="onDownload()"
    (reject)="closeDialog()"
    (closed)="closeDialog()">
    <div class="space-y-3">
      <div class="text-sm text-gray-700">
        Escanea este codigo para autocompletar el formulario de vehiculo.
      </div>
      @if (qrData()?.qrCodeDataUrl; as qr) {
        <div class="flex items-center justify-center">
          <img [src]="qr" alt="QR del vehiculo" class="w-48 h-48 object-contain" />
        </div>
      }
    </div>
  </app-modal-dialog>
</app-wizard-layout>

