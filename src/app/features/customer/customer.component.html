<app-wizard-layout
  [currentStep]="1"
  [showBack]="false"
  [nextDisabled]="form.invalid"
  [isLoading]="isLoading()"
  (nextClick)="onNext()">

  <app-content-card title="Información del Cliente">
    <form [formGroup]="form" class="flex flex-col gap-4">
      <div class="flex justify-end mb-4">
        <button class="td-btn td-btn--standard" type="button" (click)="scanId()" aria-label="Escanear DNI para autocompletar formulario">
          Escanear DNI
        </button>
      </div>

      <app-barcode-scanner-dialog
        [isOpen]="isScannerOpen()"
        title="Escanear DNI"
        [formats]="dniScannerFormats"
        (scanned)="onDniScanned($event)"
        (closed)="closeScanner()"
      />

      @if (errorMessage()) {
        <div class="p-3 bg-red-50 border border-red-200 rounded text-red-700 text-sm" role="alert">
          {{ errorMessage() }}
        </div>
      }

      <div class="mb-4">
        <label for="firstName" class="block text-sm font-medium text-gray-700 mb-1">
          Nombre *
        </label>
        <input
          type="text"
          id="firstName"
          formControlName="firstName"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 td-ring-primary"
          aria-required="true" />
      </div>

      <div class="mb-4">
        <label for="lastName" class="block text-sm font-medium text-gray-700 mb-1">
          Apellido *
        </label>
        <input
          type="text"
          id="lastName"
          formControlName="lastName"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 td-ring-primary"
          aria-required="true" />
      </div>

      <div class="mb-4">
        <label for="dni" class="block text-sm font-medium text-gray-700 mb-1">
          DNI *
          @if (isDniLoading()) {
            <span class="ml-2 text-xs td-text-primary">Buscando...</span>
          }
        </label>
        <input
          type="text"
          id="dni"
          formControlName="dni"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 td-ring-primary"
          aria-required="true" />
      </div>

      <div class="mb-4">
        <label for="phoneNumber" class="block text-sm font-medium text-gray-700 mb-1">
          Teléfono
        </label>
        <input
          type="tel"
          id="phoneNumber"
          formControlName="phoneNumber"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 td-ring-primary" />
      </div>

      <div class="mb-4">
        <label for="email" class="block text-sm font-medium text-gray-700 mb-1">
          Correo Electrónico
        </label>
        <input
          type="email"
          id="email"
          formControlName="email"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 td-ring-primary" />
      </div>
    </form>
  </app-content-card>

</app-wizard-layout>
