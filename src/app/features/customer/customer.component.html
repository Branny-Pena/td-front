<app-wizard-layout
  [currentStep]="1"
  [showBack]="false"
  [nextDisabled]="form.invalid || isLoading()"
  [isLoading]="isLoading()"
  (nextClick)="onNext()">

  <app-content-card title="Información del Cliente">
    <form [formGroup]="form" class="flex flex-col gap-4">
      <app-barcode-scanner-dialog
        [isOpen]="isScannerOpen()"
        title="Escanear DNI"
        [formats]="dniScannerFormats"
        (scanned)="onDniScanned($event)"
        (closed)="closeScanner()"
      />

      @if (errorMessage()) {
        <div class="p-3 bg-red-50 border border-red-200 rounded text-red-700 text-sm" role="alert">
          {{ errorMessage() }}
        </div>
      }

      <div class="mb-4">
        <input
          type="text"
          id="firstName"
          formControlName="firstName"
          placeholder="Nombre *"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 td-ring-primary"
          aria-label="Nombre"
          aria-required="true" />
      </div>

      <div class="mb-4">
        <input
          type="text"
          id="lastName"
          formControlName="lastName"
          placeholder="Apellido *"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 td-ring-primary"
          aria-label="Apellido"
          aria-required="true" />
      </div>

      <div class="mb-4">
        <div class="flex items-center gap-2">
          <input
            type="text"
            id="dni"
            formControlName="dni"
            placeholder="DNI *"
            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 td-ring-primary"
            aria-label="DNI"
            aria-required="true" />
          <button
            class="td-btn td-btn--standard !px-2 !py-2"
            type="button"
            (click)="scanId()"
            aria-label="Escanear DNI para autocompletar formulario">
            <svg viewBox="0 0 24 24" class="h-4 w-4" aria-hidden="true" fill="none" stroke="currentColor" stroke-width="1.5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M7 4h10a2 2 0 012 2v2M7 20h10a2 2 0 002-2v-2M4 7V6a2 2 0 012-2h2M4 17v1a2 2 0 002 2h2M8 9h8v6H8z" />
            </svg>
          </button>
        </div>
        @if (isDniLoading()) {
          <span class="mt-1 inline-block text-xs td-text-primary">Buscando...</span>
        }
      </div>

      <div class="mb-4">
        <input
          type="tel"
          id="phoneNumber"
          formControlName="phoneNumber"
          placeholder="Teléfono"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 td-ring-primary" />
      </div>

      <div class="mb-4">
        <input
          type="email"
          id="email"
          formControlName="email"
          placeholder="Correo electrónico"
          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 td-ring-primary" />
      </div>
    </form>
  </app-content-card>

</app-wizard-layout>
